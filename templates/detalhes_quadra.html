<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhes - {{ quadra.nome }}</title>
    <!-- Carrega o CSS base e o CSS espec√≠fico para esta p√°gina -->
    <link rel="icon" href="{{ url_for('static', filename='assets/logo.png') }}" type="image/x-png">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
    <!-- Carrega o script do tema no head para evitar 'flash' -->
    <script src="{{ url_for('static', filename='js/theme_switcher.js') }}" defer></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/detalhes_fullscreen.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="background-shapes"></div>
    <div class="content-container" data-quadra-id="{{ quadra.id }}" data-quadra-tipo="{{ quadra.tipo }}">
        <header class="page-header">
            <a href="{{ url_for('explorar') }}" class="back-button">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>
                <span>Voltar</span>
            </a>
            <h1 class="page-title">{{ quadra.nome }}</h1>
        </header>
        <p class="page-subtitle">{{ quadra.cidade }}, {{ quadra.estado }}</p>

        <div class="tabs">
            <button class="tab active" data-tab="reserva">üïê Hor√°rios</button><button class="tab" data-tab="mapa">üìç Localiza√ß√£o</button>
        </div>

        <div id="reserva" class="tab-content active">
            <div class="tabs-datas">
                {% for data_str in quadra.datas_disponiveis %}
                    {% set dia = data_str.split('-')[2] %}
                    {% set mes = data_str.split('-')[1] %}
                    <button class="tab-data {% if loop.first %}active{% endif %}" data-data="{{ data_str }}">
                        {{ "Hoje" if data_str == hoje else dia + '/' + mes }}
                    </button>
                {% endfor %}
            </div>
            <div class="tabs-esportes">
                {% for esporte in quadra.esportes %}
                <button class="tab-esporte {% if loop.first %}active{% endif %}" data-esporte="{{ esporte }}">{{ esporte }}</button>
                {% endfor %}
            </div>

            <div class="schedule-grid">
                {% for horario in quadra.horarios %}
                
                <div class="card-horario" 
                     data-horario-id="{{ horario.id }}"
                     data-esporte-reservado="{{ horario.esporte_reservado or '' }}">
                    
                    <div class="time-slot-time">{{ horario.hora_texto }}</div>
                    
                    <div class="vagas">
                        <span class="esporte-travado"></span>
                        <span class="contagem">{{ horario.jogadores_atuais }} / {{ horario.max_jogadores }}</span>
                    </div>
                    
                    <progress class="barra-vagas" value="{{ horario.jogadores_atuais }}" max="{{ horario.max_jogadores }}"></progress>
                    
                    {% if horario.usuario_esta_na_partida %}
                        <button class="btn btn-sair">Sair da Partida</button>
                    {% else %}
                        <button class="btn btn-entrar">
                            {% if quadra.tipo == 'publica' %}
                                Entrar na Partida
                            {% elif quadra.tipo == 'privada' and horario.esporte_reservado %}
                                Entrar (R$ {{ "%.2f"|format(horario.preco) }})
                            {% else %}
                                Reservar (R$ {{ "%.2f"|format(horario.preco) }})
                            {% endif %}
                        </button>
                    
                    {% endif %}
                    </div>
                {% else %}
                    <p>Nenhum hor√°rio dispon√≠vel no momento.</p>
                {% endfor %}
            </div>
        </div>

        <div id="mapa" class="tab-content">
            <h2>Como Chegar</h2>
            <div class="info-card">
                <h3>Endere√ßo</h3>
                <p><strong>{{ quadra.nome }}</strong></p>
                <p>Rua dos Esportes, 1234 - Centro</p>
                <p>{{ quadra.cidade }} - {{ quadra.estado }}</p>
            </div>
            <div class="map-container">
                <iframe 
                    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d119027.42080356064!2d-47.50417912192121!3d-20.52504987748408!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x94b0a612d7829b37%3A0x8640c49f4f3c7131!2sFranca%20-%20SP!5e0!3m2!1spt-BR!2sbr!4v1730043285773!5m2!1spt-BR!2sbr" 
                    width="100%" height="100%" style="border:0;" 
                    allowfullscreen="" loading="lazy" 
                    referrerpolicy="no-referrer-when-downgrade">
                </iframe>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/detalhes.js') }}"></script>
</body>
</html>